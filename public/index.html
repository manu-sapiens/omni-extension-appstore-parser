<!DOCTYPE html>
<html>
<head>
    <style>
        body {
          font-family: ui-sans-serif, system-ui, -apple-system, "system-ui", "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji";
          background-color: #F1F5F8;
          padding: 20px; /* Add padding around the text */
        }
        h1 {
          color: #303030;
        }
        .category-section {
            padding-left: 20px;
        }
        .count {
          color: #eaa504;
          font-weight: bold;
        }
        .category {
          color: #303030;
          font-weight: bold;
        }
        .description, .actions .count{
          /* margin-left: 10px; */
          font-size: 1em;
          /* text-align: justify;  */
          line-height: 1.5; /* Increase the line height */
        }
  
        .actions {
          color: #3647c8;
          font-weight: bold;
        }
      </style>

  <script>
    function displayText() {
      const messages = window.parent.client.chat.state.messages;

      // Select the latest message
      let text = messages[messages.length - 1].text;

      // Remove HTML tags and parse JSON
      const data = JSON.parse(text.replace(/<\/?p>/g, ''));

      let htmlContent = '';

      data.forEach((section, index) => {
          const {Category, Count, Summary, Actions} = section;

          // Convert the Summary array into a single string of paragraphs
          const summaryHtml = Summary.map(summary => `<p>${summary}</p>`).join('');

          htmlContent += `
            
              <h1 class="category">Category: ${Category}</h1>
              <div class="category-section">
                  <div class="count">Count: ${Count}</div>
                  <h2>Insight:</h2>
                  <div class="description">${summaryHtml}</div>
                  <h2>Action Items:</h2>
                  <div class="actions">${Actions}</div>
              </div>
              <br/>
          `;
      });

      document.getElementById('content').innerHTML = htmlContent;
  }

    window.onload = displayText;
  </script>

</head>
<body>
  <div id="content"></div>
</body>
</html>
